<?php 
    $page = "announcement";
    $id = $_GET['edit'];
    require_once 'includes/dbh.inc.php';
    require_once 'includes/functions.inc.php';
    $announcement = getUserData($connection, "announcement", "ANNOUNCEMENT_ID", $id);
    include("header.html");
    if (!isset($_SESSION['admin-data'])) {
        header("location: ../login/admin.html");
        exit();
    }
?>
    <div class="container-fluid">
        <h3 class="text-dark mb-4">Events</h3>
        <div class="row d-flex justify-content-center">
            <div class="col-md-8 col-lg-6 col-xl-5 col-xxl-4">
                <div class="card mb-5">
                    <div class="card-body p-sm-5">
                        <h2 class="text-center mb-4">Update Event</h2>
                        <form action="includes/add-announcement.inc.php?edit=<?php echo($id); ?>" method="post">
                            <?php foreach($announcement as $user): ?>
                            <div class="mb-3"><input class="form-control" type="text" id="announcement" name="announcement" placeholder="Announcement Title" value="<?php echo($user['TITLE']); ?>"></div>
                            <div class="mb-3">
                                <select class="form-select" id="announcementFor" name="announcementFor" required>
                                    <option disabled selected value="">Announcement For?</option>
                                    <?php 
                                        $selected = $user['ANNOUNCEMENT_FOR'];
                                        $options = array('All','Administrator','PWD','Senior Citizen','Solo Parent');
                                        foreach($options as $option) {
                                            if($selected == $option) {
                                                echo '<option selected value="'; echo $option; echo'">'; echo $option; echo'</option>';
                                            } else {
                                                echo '<option value="'; echo $option; echo'">'; echo $option; echo'</option>';
                                            }
                                        }
                                    ?>
                                </select></div>
                            <div class="mb-3" id="coveredMonths" style="display: none;">
                                <label for="">Covered Birthday Months</label>
                                <div class="row">
                                    <div class="col">
                                        <select class="form-select" id="from" name="from" disabled>
                                            <option disabled selected value="">Date</option>
                                            <option value="01" <?php echo ($user['DATE_FROM'] == '01') ? 'selected' : ''; ?> >January - June</option>
                                            <option value="02" <?php echo ($user['DATE_FROM'] == '02') ? 'selected' : ''; ?> >July - December</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <select class="form-select" id="barangay" name="barangay" required>
                                    <option disabled selected value="">Please Select Barangay</option>
                                    <?php 
                                        $selected = $user['BARANGAY'];
                                        $barangay = array('All','Aplaya','Balibago','Caingin','Dila','Dita','Don Jose','Ibaba','Kanluran','Labas','Macabling','Malitlit','Malusak','Market Area','Pook','Pulong Santa Cruz'
                                        ,'Santo Domingo','Sinalhan','Tagapo');
                                        foreach($barangay as $option) {
                                            if($selected == $option) {
                                                echo '<option selected value="'; echo $option; echo'">'; echo $option; echo'</option>';
                                            } else {
                                                echo '<option value="'; echo $option; echo'">'; echo $option; echo'</option>';
                                            }
                                        }
                                    ?>
                                </select></div>
                            <div class="mb-3">
                                <label for="announcementDate">Set Date for event</label>
                                <input class="form-control" type="date" name="announcementDate" id="announcementDate" min="1900-01-01" required value="<?php echo($user['DATE']); ?>">
                            </div>
                            <div class="mb-3"><textarea class="form-control" id="announcementMessage" name="announcementMessage" rows="6" placeholder="Announcement Message" ><?php echo($user['MESSAGE']); ?></textarea></div>
                            <div><button class="btn btn-primary d-block w-100" type="submit" name="update-announcement-submit">Update Announcement</button></div>
                            <?php endforeach; ?>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
<?php
    include "footer.html";
?>