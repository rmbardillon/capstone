<?php
    if(isset($_GET['person_id'])) {
        $page = "print-id";
        require_once '../includes/dbh.inc.php';
        require_once '../includes/sql.inc.php';
        $person_id = $_GET['person_id'];
        $userData = getPWDData($connection, $person_id);
        $genderData = getPWDGender($connection, $person_id);
        $guardian = getGuardianData($connection, $person_id);
    } else {
        header("location: ../print-id.html");
        exit();
    }
    $result = array_map(null, $userData, $genderData, $guardian);
    foreach($result as list($data, $gender, $guardian)):
        $typeOfDisability = explode(',', $data['TYPE_OF_DISABILITY']);
?>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>ID</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>

<body>
    <div class="d-flex align-items-start">
        <div id="id" class="p-3" style="height: 240px;width: 365px;">
            <div id="information">
                <div class="row">
                    <div class="col border">
                        <p style="font-size: 10px;">TYPE OF DISABILITY<strong style="margin-left: 10px;font-size: 10px;"><?php echo(strtoupper($typeOfDisability[0])); ?></strong></p>
                    </div>
                </div>
                <div class="row" style="font-size: 15px;">
                    <div class="col col-8 border" style="font-size: 15px;">
                        <p style="font-size: 10px;">DATE OF BIRTH<strong style="margin-left: 10px;font-size: 10px;"><?php echo(strtoupper(date('F j, Y', strtotime($data['DATE_OF_BIRTH'])))); ?></strong></p>
                    </div>
                    <div class="col col-4 border" style="font-size: 15px;">
                        <p style="font-size: 10px;">GENDER<strong style="margin-left: 10px;font-size: 10px;"><?php echo(strtoupper($gender['GENDER'])); ?></strong></p>
                    </div>
                </div>
                <div class="row" style="font-size: 15px;">
                    <div class="col border" style="font-size: 15px;">
                        <p style="font-size: 7px;">HOME ADDRESS<strong style="margin-left: 10px;font-size: 10px;"><?php echo(strtoupper($data['ADDRESS'] . " BARANGAY " .$data['BARANGAY']." SANTA ROSA LAGUNA")); ?></strong></p>
                    </div>
                </div>
                <div class="row" style="font-size: 15px;">
                    <div class="col col-7 border" style="font-size: 15px;">
                        <p style="font-size: 10px;">DATE ISSUED<strong style="margin-left: 10px;font-size: 10px;"><?php echo(strtoupper(date('F j, Y'))); ?></strong></p>
                    </div>
                    <div class="col border" style="font-size: 15px;">
                        <p style="font-size: 10px;">BLOOD TYPE<strong style="margin-left: 10px;font-size: 10px;"><?php echo(strtoupper($data['BLOOD_TYPE'])); ?></strong></p>
                    </div>
                </div>
            </div>
            <div class="row" style="font-size: 15px;">
                <div class="col text-center" style="font-size: 15px;">
                    <p style="font-size: 15px;margin-top: -6px;"><strong style="font-size: 7px;">IN CASE OF EMERGENCY PLESE NOTIFY</strong></p>
                </div>
            </div>
            <div class="row" style="font-size: 15px;margin-top: -10px;">
                <div class="col col-4" style="font-size: 15px;padding-top: 9px;">
                    <p style="font-size: 10px;">NAME</p>
                </div>
                <div class="col border-bottom" style="font-size: 15px;margin-left: -40px;">
                    <p style="font-size: 15px;padding-left: 0px;"><strong style="font-size: 10px;"><?php echo($guardian['FIRST_NAME']." ".$guardian['MIDDLE_NAME']." ".$guardian['LAST_NAME']." ".$guardian['SUFFIX']); ?></strong></p>
                </div>
            </div>
            <div class="row" style="font-size: 15px;margin-top: -10px;">
                <div class="col col-4" style="font-size: 15px;padding-top: 9px;">
                    <p style="font-size: 10px;">ADDRESS</p>
                </div>
                <div class="col border-bottom" style="font-size: 15px;margin-left: -40px;">
                    <p style="font-size: 15px;"><strong style="font-size: 10px;">SAME ADDRESS</strong></p>
                </div>
            </div>
            <div class="row" style="font-size: 15px;margin-top: -10px;">
                <div class="col col-4" style="font-size: 15px;padding-top: 9px;">
                    <p style="font-size: 10px;">CONTACT NO.</p>
                </div>
                <div class="col border-bottom" style="font-size: 15px;margin-left: -40px;">
                    <p style="font-size: 15px;"><strong style="font-size: 10px;">CP# 09123456789</strong></p>
                </div>
            </div>
            <?php endforeach; ?>
            <div class="row">
                <div class="col text-center" style="padding-top: 10px;">
                    <p style="font-size: 8px;"><strong style="font-size: 9px;">--------------------------------</strong></p>
                    <p style="font-size: 8px;">Signature</p>
                </div>
            </div>
            <div class="row">
                <div class="col border text-center">
                    <p style="font-size: 6px;">The Holder of this card is person with disability and is entitled to discounts on medical, dental, transportation, admission fees, in all establishments and educational assistance as authorized by law. Any violation thereof is punishable.</p>
                    <p style="color: var(--bs-pink);font-size: 6px;">THIS CARD IS NON-TRANSFERABLE&nbsp;</p>
                    <p style="color: var(--bs-pink);font-size: 6px;">VALID FOR THREE(3) YEARS</p>
                </div>
            </div>
        </div>
    </div>
    <button class="btn btn-primary" id="print_button">Print</button>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>