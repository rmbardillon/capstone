<?php 
    require_once 'includes/dbh.inc.php';
    require_once 'includes/functions.inc.php';
    require_once 'includes/sql.inc.php';
    if(isset($_GET['event'])) {
        $page = "announcement";
        $event_id = $_GET['event'];
    } else {
        $page = "pending-requests";
    }
    $PERSON_ID = $_GET['id'];
    $userData = getSoloParentData($connection, $PERSON_ID);
    $genderData = getSoloParentGender($connection, $PERSON_ID);
    $family = getFamilyMemberData($connection, $PERSON_ID);
    include("header.html");
    if (!isset($_SESSION['admin-data'])) {
        header("location: ../login/admin.html");
        exit();
    }
    $result = array_map(null, $userData, $genderData);
    foreach($result as list($data, $gender)):
?>
<div>
    <div class="container form">
        <h1 class="heading">Solo Parent Application</h1>
      <form action="includes/approved.inc.php" method="post" novalidate="">
        <!-- <h5 class="text-center">APPLICATION&nbsp;FORM FOR SOLO PARENT</h5> -->
        <div class="row">
          <div class="col">
            <label class="form-label required" for="surname">SURNAME</label>
            <input
              class="form-control"
              type="text"
              id="surname"
              name="surname"
              readonly=""
              value="<?php echo($data['LAST_NAME']); ?>"
            />
          </div>
          <div class="col">
            <label class="form-label required" for="firstName">
              FIRST NAME
            </label>
            <input
                class="form-control"
                type="text"
                id="firstName"
                name="firstName"
                readonly=""
                value="<?php echo($data['FIRST_NAME']); ?>"
            />
          </div>
          <div class="col">
            <label class="form-label" for="middlename">MIDDLE NAME</label>
            <input
              class="form-control"
              type="text"
              id="middlename"
              name="middlename"
              readonly=""
                value="<?php echo($data['MIDDLE_NAME']); ?>"
            />
          </div>
          <div class="col">
            <label class="form-label" for="suffix">SUFFIX</label>
            <select id="suffix" class="form-select" name="suffix" disabled>
              <option disabled selected value="">Please Select</option>
              <option value="" <?php echo ($data['SUFFIX'] == '') ? 'selected' : ''; ?> >N/A</option>
              <option value="Jr." <?php echo ($data['SUFFIX'] == 'Jr.') ? 'selected' : ''; ?> >Jr.</option>
              <option value="Sr." <?php echo ($data['SUFFIX'] == 'Sr.') ? 'selected' : ''; ?> >Sr.</option>
              <option value="II" <?php echo ($data['SUFFIX'] == 'II') ? 'selected' : ''; ?> >II</option>
              <option value="III" <?php echo ($data['SUFFIX'] == 'III') ? 'selected' : ''; ?> >III</option>
              <option value="IV" <?php echo ($data['SUFFIX'] == 'IV') ? 'selected' : ''; ?> >IV</option>
              <option value="V" <?php echo ($data['SUFFIX'] == 'V') ? 'selected' : ''; ?> >V</option>
              <option value="VI" <?php echo ($data['SUFFIX'] == 'VI') ? 'selected' : ''; ?> >VI</option>
              <option value="VII" <?php echo ($data['SUFFIX'] == 'VII') ? 'selected' : ''; ?> >VII</option>
              <option value="VIII" <?php echo ($data['SUFFIX'] == 'VIII') ? 'selected' : ''; ?> >VIII</option>
              <option value="IX" <?php echo ($data['SUFFIX'] == 'IX') ? 'selected' : ''; ?> >IX</option>
              <option value="X" <?php echo ($data['SUFFIX'] == 'X') ? 'selected' : ''; ?> >X</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="col col-3">
            <label class="form-label required" for="soloParentDOB">
              DATE OF BIRTH
            </label>
            <input
              class="form-control"
              id="soloParentDOB"
              type="date"
              name="soloParentDOB"
              disabled
              min="1900-01-01"
              readonly
                value="<?php echo($data['DATE_OF_BIRTH']); ?>"
            />
          </div>
          <div class="col col-3">
            <label class="form-label" for="age">AGE</label>
            <input
              class="form-control"
              type="text"
              id="age"
              disabled=""
              name="age"
              value="<?php echo(ageCalculator($data['DATE_OF_BIRTH'])); ?>"
            />
          </div>
          <div class="col">
            <label class="form-label required" for="placeOfBirth">
              PLACE OF BIRTH
            </label>
            <input
              class="form-control"
              type="text"
              id="placeOfBirth"
              name="placeOfBirth"
              disabled
                value="<?php echo($data['PLACE_OF_BIRTH']); ?>"
            />
          </div>
        </div>
        <div class="row">
          <div class="col col-2">
            <label class="form-label required" for="gender">SEX</label>
            <select id="gender" class="form-select" name="gender" disabled>
              <option disabled selected value="">Please Select</option>
              <option value="Male" <?php echo ($gender['GENDER'] == 'Male') ? 'selected' : ''; ?> >Male</option>
              <option value="Female" <?php echo ($gender['GENDER'] == 'Female') ? 'selected' : ''; ?> >Female</option>
            </select>
          </div>
          <div class="col col-3">
            <label class="form-label required" for="barangay">BARANGAY</label>
            <select id="barangay" class="form-select" name="barangay" disabled>
              <option disabled selected value="">Please Select</option>
              <option value="Aplaya" <?php echo ($data['BARANGAY'] == 'Aplaya') ? 'selected' : ''; ?> >Aplaya</option>
              <option value="Balibago" <?php echo ($data['BARANGAY'] == 'Balibago') ? 'selected' : ''; ?> >Balibago</option>
              <option value="Caingin" <?php echo ($data['BARANGAY'] == 'Caingin') ? 'selected' : ''; ?> >Caingin</option>
              <option value="Dila" <?php echo ($data['BARANGAY'] == 'Dila') ? 'selected' : ''; ?> >Dila</option>
              <option value="Dita" <?php echo ($data['BARANGAY'] == 'Dita') ? 'selected' : ''; ?> >Dita</option>
              <option value="Don Jose" <?php echo ($data['BARANGAY'] == 'Don Jose') ? 'selected' : ''; ?> >Don Jose</option>
              <option value="Ibaba" <?php echo ($data['BARANGAY'] == 'Ibaba') ? 'selected' : ''; ?> >Ibaba</option>
              <option value="Kalnuran" <?php echo ($data['BARANGAY'] == 'Kanluran') ? 'selected' : ''; ?> >Kanluran</option>
              <option value="Labas" <?php echo ($data['BARANGAY'] == 'Labas') ? 'selected' : ''; ?> >Labas</option>
              <option value="Macabling" <?php echo ($data['BARANGAY'] == 'Macabling') ? 'selected' : ''; ?> >Macabling</option>
              <option value="Malitlit" <?php echo ($data['BARANGAY'] == 'Malitlit') ? 'selected' : ''; ?> >Malitlit</option>
              <option value="Malusak" <?php echo ($data['BARANGAY'] == 'Malusak') ? 'selected' : ''; ?> >Malusak</option>
              <option value="Market Area" <?php echo ($data['BARANGAY'] == 'Market Area') ? 'selected' : ''; ?> >Market Area</option>
              <option value="Pook" <?php echo ($data['BARANGAY'] == 'Pook') ? 'selected' : ''; ?> >Pook</option>
              <option value="Pulong Santa Cruz" <?php echo ($data['BARANGAY'] == 'Pulong Santa Cruz') ? 'selected' : ''; ?> >Pulong Santa Cruz</option>
              <option value="Santo Domingo" <?php echo ($data['BARANGAY'] == 'Santo Domingo') ? 'selected' : ''; ?> >Santo Domingo</option>
              <option value="Sinalhan" <?php echo ($data['BARANGAY'] == 'Sinalhan') ? 'selected' : ''; ?> >Sinalhan</option>
              <option value="Tagapo" <?php echo ($data['BARANGAY'] == 'Tagapo') ? 'selected' : ''; ?> >Tagapo</option>
            </select>
          </div>
          <div class="col">
            <label class="form-label required" for="address">ADDRESS</label>
            <input
              class="form-control"
              type="text"
              id="address"
              name="address"
              disabled
                value="<?php echo($data['ADDRESS']); ?>"
            />
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label class="form-label required" for="educationalAttainment">
              HIGHEST EDUCATIONAL ATTAINMENT
            </label>
            <input
              class="form-control"
              type="text"
              id="educationalAttainment"
              name="educationalAttainment"
              disabled
                value="<?php echo($gender['EDUCATIONAL_ATTAINMENT']); ?>"
            />
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label class="form-label required" id="job" for="job">
              OCCUPATION
            </label>
            <input
              class="form-control"
              type="text"
              id="job"
              name="job"
              disabled
                value="<?php echo($data['JOB']); ?>"
            />
          </div>
          <div class="col">
            <label class="form-label required" for="company">
              COMPANY/AGENCY
            </label>
            <input
              class="form-control"
              type="text"
              id="company"
              name="company"
              disabled
                value="<?php echo($data['COMPANY']); ?>"
            />
          </div>
        </div>
        <div class="row">
          <div class="col">
            <label class="form-label required" for="monthlyIncome">
              MONTHLY INCOME
            </label>
            <input
              class="form-control numbers"
              type="text"
              id="monthlyIncome"
              name="monthlyIncome"
              disabled
                value="<?php echo number_format($data['MONTHLY_INCOME']); ?>"
            />
          </div>
          <div class="col">
            <label
              class="form-label howMuchPension required"
              for="totalFamilyIncome"
            >
              TOTAL FAMILY INCOME
            </label>
            <input
              class="form-control numbers"
              type="text"
              id="totalFamilyIncome"
              name="totalFamilyIncome"
              disabled
                value="<?php echo number_format($data['TOTAL_FAMILY_INCOME']); ?>"
            />
          </div>
          <div class="col">
            <label class="form-label" for="telephone">
              TELEPHONE/CELLPHONE NUMBER
            </label>
            <input
              class="form-control numbers telephone"
              type="tel"
              id="telephone"
              name="telephone"
              placeholder="09##-###-####"
                disabled
                    value="<?php echo($data['TELEPHONE_NUMBER']); ?>"
            />
          </div>
          <div class="col">
            <label class="form-label required" for="email">
              EMAIL ADDRESS
            </label>
            <input
              class="form-control"
              type="email"
              id="email"
              name="email"
              placeholder="email@example.com"
              disabled
                value="<?php echo($data['EMAIL']); ?>"
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <h5 class="text-start">I. FAMILY COMPOSITION</h5>
          </div>
        </div>
        <?php foreach($family as $familyData): ?>
        <div id="soloParentRelative" class="soloParentRelative">
          <div class="row" id="child">
            <div class="col col-2 d-flex align-items-center">
              <h6 class="text-nowrap text-start">NAME</h6>
            </div>
            <div class="col">
              <input
                class="form-control"
                type="text"
                id="childLastName"
                name="childLastName[]"
                placeholder="SURNAME"
                readonly
                value="<?php echo($familyData['CHILD_LAST_NAME']); ?>"
              />
            </div>
            <div class="col">
              <input
                class="form-control"
                type="text"
                id="childFirstName"
                name="childFirstName[]"
                placeholder="FIRST NAME"
                readonly
                value="<?php echo($familyData['CHILD_FIRST_NAME']); ?>"
              />
            </div>
            <div class="col">
              <input
                class="form-control"
                type="text"
                id="childMiddleName"
                name="childMiddleName[]"
                placeholder="MIDDLE NAME"
                readonly
                value="<?php echo($familyData['CHILD_MIDDLE_NAME']); ?>"
              />
            </div>
            <div class="col">
              <input
                class="form-control"
                type="text"
                id="childSuffix"
                name="childSuffix[]"
                placeholder="SUFFIX"
                readonly
                value="<?php echo($familyData['CHILD_SUFFIX']); ?>"
              />
            </div>
          </div>
          <div class="row">
            <div class="col d-flex align-items-center">
              <h6 class="text-start">RELATIONSHIP</h6>
            </div>
            <div class="col">
              <input
                class="form-control"
                id="soloParentChildRelationship"
                type="text"
                name="soloParentChildRelationship[]"
                readonly
                value="<?php echo($familyData['RELATIONSHIP_TYPE']); ?>"
              />
            </div>
            <div class="col col-2 d-flex align-items-center">
              <h6 class="text-start">DATE&nbsp;OF BIRTH</h6>
            </div>
            <div class="col col-3">
              <input
                class="form-control"
                id="soloParentChildDOB"
                type="date"
                name="soloParentChildDOB[]"
                min="1900-01-01"
                readonly
                value="<?php echo($familyData['CHILD_DOB']); ?>"
              />
            </div>
            <div class="col col-2 d-flex align-items-center">
              <h6 class="text-start">MARITAL&nbsp;STATUS</h6>
            </div>
            <div class="col d-flex align-items-center">
              <select
                id="maritalStatus"
                class="form-select"
                name="maritalStatus[]"
                disabled
              >
                <option disabled selected value="">Please Select</option>
              <option value="Single" <?php echo ($familyData['FAMILY_MARITAL_STATUS'] == 'Single') ? 'selected' : ''; ?> >Single</option>
              <option value="Married" <?php echo ($familyData['FAMILY_MARITAL_STATUS'] == 'Married') ? 'selected' : ''; ?> >Married</option>
              <option value="Widowed" <?php echo ($familyData['FAMILY_MARITAL_STATUS'] == 'Widowed') ? 'selected' : ''; ?> >Widowed</option>
              <option value="Separated" <?php echo ($familyData['FAMILY_MARITAL_STATUS'] == 'Separated') ? 'selected' : ''; ?> >Separated</option>
              <option value="Divorced" <?php echo ($familyData['FAMILY_MARITAL_STATUS'] == 'Divorced') ? 'selected' : ''; ?> >Divorced</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div class="col col-3 d-flex align-items-center">
              <h6 class="text-start">EDUCATIONAL&nbsp;ATTAINMENT</h6>
            </div>
            <div class="col">
              <input
                class="form-control"
                type="text"
                id="childEducationalAttainment"
                name="childEducationalAttainment[]"
                readonly
                value="<?php echo($familyData['EDUCATIONAL_ATTAINMENT']); ?>"
              />
            </div>
            <div class="col col d-flex align-items-center">
              <h6 class="text-start required">OCCUPATION</h6>
            </div>
            <div class="col">
              <select
              id="childOccupation"
              class="form-select"
              name="childOccupation[]"
              disabled
            >
              <option disabled selected value="">Please Select</option>
              <option value="Unemployed" <?php echo ($familyData['JOB'] == 'Unemployed') ? 'selected' : ''; ?> >Unemployed</option>
                <option value="Managers" <?php echo ($familyData['JOB'] == 'Managers') ? 'selected' : ''; ?> >Managers</option>
                <option value="Professionals" <?php echo ($familyData['JOB'] == 'Professionals') ? 'selected' : ''; ?> >Professionals</option>
                <option value="Technician & Associate Professionals" <?php echo ($familyData['JOB'] == 'Technician & Associate Professionals') ? 'selected' : ''; ?> >
                    Technician & Associate Professionals
                </option>
                <option value="Clerical Support Workers" <?php echo ($familyData['JOB'] == 'Clerical Support Workers') ? 'selected' : ''; ?> >
                    Clerical Support Workers
                </option>
                <option value="Service & Sales Workers" <?php echo ($familyData['JOB'] == 'Service & Sales Workers') ? 'selected' : ''; ?> >
                    Service & Sales Workers
                </option>
                <option value="Skilled Agricultural, Forestry & Fishery Workers" <?php echo ($familyData['JOB'] == 'Skilled Agricultural, Forestry & Fishery Workers') ? 'selected' : ''; ?> >
                    Skilled Agricultural, Forestry & Fishery Workers
                </option>
                <option value="Craft & Related Trade Workers" <?php echo ($familyData['JOB'] == 'Craft & Related Trade Workers') ? 'selected' : ''; ?> >
                    Craft & Related Trade Workers
                </option>
                <option value="Plant & Machine Operators & Assemblers" <?php echo ($familyData['JOB'] == 'Plant & Machine Operators & Assemblers') ? 'selected' : ''; ?> >
                    Plant & Machine Operators & Assemblers
                </option>
                <option value="Elementary Occupations" <?php echo ($familyData['JOB'] == 'Elementary Occupations') ? 'selected' : ''; ?> >
                    Elementary Occupations
                </option>
                <option value="Armed Forces Occupations" <?php echo ($familyData['JOB'] == 'Armed Forces Occupations') ? 'selected' : ''; ?> >
                    Armed Forces Occupations
                </option>
                <option value="Others" <?php echo ($familyData['JOB'] == 'Others') ? 'selected' : ''; ?> >Others</option>
            </select>
            </div>
            <div class="col">
                <input
              class="form-control mt-1"
              type="text"
              id="otherChildOccupation"
              placeholder="specify"
              name="otherChildOccupation[]"
              style="display: none;"
              value="<?php (!empty($familyData['OTHER_JOB'])) ? $data['OTHER_JOB'] : '' ?>"
            />
            </div>
            <div class="col col d-flex align-items-center">
              <h6 class="text-start required">MONTHLY&nbsp;INCOME</h6>
            </div>
            <div class="col">
              <input
                class="form-control numbers"
                type="text"
                id="childIncome"
                name="childIncome[]"
                oninput="javascript: if (this.value.length > 1 && this.value.charAt(0) === '0') this.value = this.value.substr(1);"
                value="<?php echo number_format($familyData['MONTHLY_INCOME']); ?>"
                readonly
              />
            </div>
          </div>
        </div>
        <?php endforeach; ?>
        <div class="row mt-1">
          <div class="col">
            <h6>
              NOTE: INCLUDE FAMILY MEMBER AND OTHER MEMBERS OF THE HOUSEHOLD
              ESPECIALLY MINOR CHILDREN
            </h6>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="row">
              <div class="col">
                <h5 class="text-start">
                  II. CLASSIFICATION/CIRCUMSTANCES OF BEING A SOLO PARENT:
                </h5>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <textarea
                  class="form-control"
                  id="soloParentClassification"
                  name="soloParentClassification"
                  disabled
                ><?php echo($data['CLASSIFICATION_CIRCUMSTANCES']); ?></textarea>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="row">
              <div class="col">
                <h5 class="text-start">
                  III. NEEDS/PROBLEMS OF BEING A SOLO PARENT:
                  <br />
                </h5>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <textarea
                  class="form-control"
                  id="soloParentNeeds"
                  name="soloParentNeeds"
                  disabled
                ><?php echo($data['NEEDS_PROBLEMS']); ?></textarea>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="row">
              <div class="col">
                <h5 class="text-start">
                  IV. FAMILY RESOURCES
                  <br />
                </h5>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <textarea
                  class="form-control"
                  id="soloParentFamilyResources"
                  name="soloParentFamilyResources"
                  disabled
                ><?php echo($data['FAMILY_RESOURCES']); ?></textarea>
              </div>
            </div>
          </div>
        </div>
        <?php endforeach; if(!isset($_GET['event'])){ 
            if($adminData['admin_type'] == "Main Administrator" || ($adminData['admin_type'] == "Solo Parent Administrator" && $adminData['barangay'] == "City Hall")){ ?>
        <div class="row">
          <div class="col">
            <input type="hidden" name="person_id" value="<?php echo($PERSON_ID); ?>">
            <button
              class="btn btn-primary w-100"
              type="submit"
              name="soloParentApprove"
            >
              Approve
            </button>
          </div>
          <div class="col">
            <a
              class="btn btn-danger w-100"
              href="remarks.html?application_type=soloParent&person_id=<?php echo($PERSON_ID); ?>"
            >
              Reject
            </a>
          </div>
          <?php } } else {?>
            <div class="col">
                <input class="form-control" type="file" name="" id="">
            <a
              class="btn btn-success w-100"
              href="includes/claim.inc.php?event_id=<?php echo($event_id); ?>&application_type=soloParent&person_id=<?php echo($PERSON_ID); ?>"
            >
              Claim
            </a>
          </div>
        <?php } ?>
        </div>
      </form>
    </div>
<?php
    include "footer.html";
?>
